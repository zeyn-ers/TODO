<div class="grid">

  <!-- Sidebar (Categories) -->
  <aside class="sidebar card">
    <div class="sb-header">
      <div class="title">Kategoriler</div>
      <span class="muted">{{ categories().length }} adet</span>
    </div>

    <div class="sb-add">
      <input class="input" placeholder="Yeni kategori..." [formControl]="catForm.controls.name" />
      <button class="btn" (click)="addCategory()">Ekle</button>
    </div>

    <ul class="cat-list">
      <li class="cat" [class.active]="selectedCatId()==='all'" (click)="pickCat('all')">
        <span class="dot all"></span> Tümü
      </li>
      <li
        class="cat"
        *ngFor="let c of categories()"
        [class.active]="selectedCatId()===c.id"
        (click)="pickCat(c.id)">
        <span class="dot"></span> {{ c.name }}
      </li>
    </ul>

    <hr class="sep" />
    <div class="info muted">
      <div class="tag">Notion-style UI</div>
      <div>Solda filtre, sağda içerik. Hızlı ekleme alanları 🪄</div>
    </div>
  </aside>

  <!-- Main content (Todos) -->
  <section class="content">
    <!-- Toolbar -->
    <div class="toolbar card">
      <div class="crumbs">
        <span class="pill">Dashboard</span>
        <span class="muted">/</span>
        <span class="pill">{{ selectedCategoryName() }}</span>
      </div>

      <div class="tools">
        <input
          class="input"
          placeholder="Todo ara..."
          [value]="q()"
          (input)="q.set($any($event.target).value)" />
        <button class="btn accent" (click)="addTodo()">+ Yeni</button>
      </div>
    </div>

    <!-- Quick add -->
    <div class="quick card">
      <input class="input w" placeholder="Başlık" [formControl]="todoForm.controls.title" />
      <input class="input" placeholder="Açıklama" [formControl]="todoForm.controls.description" />
      <select class="input" [formControl]="todoForm.controls.categoryId">
        <option value="all">Kategori yok</option>
        <option *ngFor="let c of categories()" [value]="c.id">{{ c.name }}</option>
      </select>
      <input class="input" type="date" [formControl]="todoForm.controls.dueDate" />
      <button class="btn" (click)="addTodo()">Ekle</button>
    </div>

    <!-- Notion-like table -->
    <div class="table card">
      <div class="thead">
        <div>Durum</div>
        <div>Başlık</div>
        <div>Kategori</div>
        <div>Son Tarih</div>
        <div class="right">İşlem</div>
      </div>

      <div class="row" *ngFor="let t of filtered()">
        <div>
          <input type="checkbox" [checked]="t.isCompleted" (change)="toggleDone(t)" />
        </div>

        <div class="title-cell">
          <div class="t">{{ t.title }}</div>
          <div class="d muted" *ngIf="t.description">{{ t.description }}</div>
        </div>

        <div>
          <span class="pill" *ngIf="t.categoryId as cid; else noCat">
            {{ catNameById(cid) }}
          </span>
          <ng-template #noCat>
            <span class="muted">—</span>
          </ng-template>
        </div>

        <div>
          <span class="muted" *ngIf="!t.dueDate">—</span>
          <span *ngIf="t.dueDate as d">{{ d | date:'dd.MM.yyyy' }}</span>
        </div>

        <div class="right">
          <button class="btn" (click)="removeTodo(t)">Sil</button>
        </div>
      </div>

      <div class="empty muted" *ngIf="filtered().length===0">
        Hiç kayıt yok. Üstteki “Yeni” ile hızlıca ekleyebilirsin.
      </div>
    </div>
  </section>
</div>
